<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="UTF-8">
	<title>Friend Finder</title>
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<!-- 	Jquery -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
	<!-- Link to Local Stylesheet -->
	<link rel="stylesheet" type="text/css" href="css/style.css">
	<!-- Link to Google Fonts -->
	<link href="https://fonts.googleapis.com/css?family=Kite+One|Vast+Shadow" rel="stylesheet">
</head>
<body>
	<!-- Main Container -->
	<div class="container">
		<div class="col-lg-12">
			<!-- Header -->
			<h1 id="surveyTitle">Survey Questions <span class="glyphicon glyphicon-user"></span></h1>
			<hr>

			<!-- Required Inputs -->
			<h3>About You</h3>
				<!-- Name Input -->
				<h4>Name (Required)</h4>
					<input type="text" name="name" id="name" class="form-control questions" required>
				<!-- Photo Input -->
				<h4>Link to Photo Image (Required)</h4>
					<input type="text" name="photo" id="photo" class="form-control questions" required>
			<hr>

			<!-- Question 1 -->
			<div class="row">
				<div class="col-sm-12">
					<h3>Question 1</h3>
					<h4>Your mind is always buzzing with unexplored ideas and plans.</h4>
				</div>
				<div class="col-sm-3">
					<div class="form-group">
	    			<select class="form-control questions" id="q1">
	    				<option selected disabled hidden id="select">Select An Option:</option>
		    			<option value="1">1 (Strongly Disagree)</option>
		    			<option value="2">2</option>
		    			<option value="3">3</option>
		    			<option value="4">4</option>
		    			<option value="5">5 (Strongly Agree)</option>
		    		</select>
		 	 		</div>
		 	 	</div>
			</div>

			<!-- Question 2 -->
			<div class="row">
				<div class="col-sm-12">
					<h3>Question 2</h3>
					<h4>Generally speaking, you rely more on your experience than your imagination.</h4>
				</div>
				<div class="col-sm-3">
					<div class="form-group">
	    			<select class="form-control questions" id="q2">
	    				<option selected disabled hidden>Select An Option:</option>
		    			<option value="1">1 (Strongly Disagree)</option>
		    			<option value="2">2</option>
		    			<option value="3">3</option>
		    			<option value="4">4</option>
		    			<option value="5">5 (Strongly Agree)</option>
		    		</select>
		 	 		</div>
		 	 	</div>
			</div>

			<!-- Question 3 -->
			<div class="row">
				<div class="col-sm-12">
					<h3>Question 3</h3>
					<h4>You find it easy to stay relaxed and focused even when there is some pressure.</h4>
				</div>
				<div class="col-sm-3">
					<div class="form-group">
	    			<select class="form-control questions" id="q3">
	    				<option selected disabled hidden>Select An Option:</option>
		    			<option value="1">1 (Strongly Disagree)</option>
		    			<option value="2">2</option>
		    			<option value="3">3</option>
		    			<option value="4">4</option>
		    			<option value="5">5 (Strongly Agree)</option>
		    		</select>
		 	 		</div>
		 	 	</div>
			</div>

			<!-- Question 4 -->
			<div class="row">
				<div class="col-sm-12">
					<h3>Question 4</h3>
					<h4>You rarely do something just out of sheer curiosity.</h4>
				</div>
				<div class="col-sm-3">
					<div class="form-group">
	    			<select class="form-control questions" id="q4">
	    				<option selected disabled hidden>Select An Option:</option>
		    			<option value="1">1 (Strongly Disagree)</option>
		    			<option value="2">2</option>
		    			<option value="3">3</option>
		    			<option value="4">4</option>
		    			<option value="5">5 (Strongly Agree)</option>
		    		</select>
		 	 		</div>
		 	 	</div>
			</div>
			
			<!-- Question 5 -->
			<div class="row">
				<div class="col-sm-12">
					<h3>Question 5</h3>
					<h4>People can rarely upset you.</h4>
				</div>
				<div class="col-sm-3">
					<div class="form-group">
	    			<select class="form-control questions" id="q5">
	    				<option selected disabled hidden>Select An Option:</option>
		    			<option value="1">1 (Strongly Disagree)</option>
		    			<option value="2">2</option>
		    			<option value="3">3</option>
		    			<option value="4">4</option>
		    			<option value="5">5 (Strongly Agree)</option>
		    		</select>
		 	 		</div>
		 	 	</div>
			</div>
			
			<!-- Question 6 -->
			<div class="row">
				<div class="col-sm-12">
					<h3>Question 6</h3>
					<h4>It is often difficult for you to relate to other people’s feelings.</h4>
				</div>
				<div class="col-sm-3">
					<div class="form-group">
	    			<select class="form-control questions" id="q6">
	    				<option selected disabled hidden>Select An Option:</option>
		    			<option value="1">1 (Strongly Disagree)</option>
		    			<option value="2">2</option>
		    			<option value="3">3</option>
		    			<option value="4">4</option>
		    			<option value="5">5 (Strongly Agree)</option>
		    		</select>
		 	 		</div>
		 	 	</div>
			</div>

			<!-- Question 7 -->
			<div class="row">
				<div class="col-sm-12">
					<h3>Question 7</h3>
					<h4>In a discussion, truth should be more important than people’s sensitivities.</h4>
				</div>
				<div class="col-sm-3">
					<div class="form-group">
	    			<select class="form-control questions" id="q7">
	    				<option selected disabled hidden>Select An Option:</option>
		    			<option value="1">1 (Strongly Disagree)</option>
		    			<option value="2">2</option>
		    			<option value="3">3</option>
		    			<option value="4">4</option>
		    			<option value="5">5 (Strongly Agree)</option>
		    		</select>
		 	 		</div>
		 	 	</div>
			</div>
			
			<!-- Question 8 -->
			<div class="row">
				<div class="col-sm-12">
					<h3>Question 8</h3>
					<h4>You rarely get carried away by fantasies and ideas.</h4>
				</div>
				<div class="col-sm-3">
					<div class="form-group">
	    			<select class="form-control questions" id="q8">
	    				<option selected disabled hidden>Select An Option:</option>
		    			<option value="1">1 (Strongly Disagree)</option>
		    			<option value="2">2</option>
		    			<option value="3">3</option>
		    			<option value="4">4</option>
		    			<option value="5">5 (Strongly Agree)</option>
		    		</select>
		 	 		</div>
		 	 	</div>
			</div>
			
			<!-- Question 9 -->
			<div class="row">
				<div class="col-sm-12">
					<h3>Question 9</h3>
					<h4>You think that everyone’s views should be respected regardless of whether they are supported by facts or not.</h4>
				</div>
				<div class="col-sm-3">
					<div class="form-group">
	    			<select class="form-control questions" id="q9">
	    				<option selected disabled hidden>Select An Option:</option>
		    			<option value="1">1 (Strongly Disagree)</option>
		    			<option value="2">2</option>
		    			<option value="3">3</option>
		    			<option value="4">4</option>
		    			<option value="5">5 (Strongly Agree)</option>
		    		</select>
		 	 		</div>
		 	 	</div>
			</div>

			<!-- Question 10 -->
			<div class="row">
				<div class="col-sm-12">
					<h3>Question 10</h3>
					<h4>You feel more energetic after spending time with a group of people.</h4>
				</div>
				<div class="col-sm-3">
					<div class="form-group">
	    			<select class="form-control questions" id="q10">
	    				<option selected disabled hidden>Select An Option:</option>
		    			<option value="1">1 (Strongly Disagree)</option>
		    			<option value="2">2</option>
		    			<option value="3">3</option>
		    			<option value="4">4</option>
		    			<option value="5">5 (Strongly Agree)</option>
		    		</select>
		 	 		</div>
		 	 	</div>
			</div>

			<hr>
			<!-- Submit Button -->
			<div class="center">
				<a href="">
					<button type="submit" class="btn btn-lg btn-primary btn-block" id="submit">Submit Your Survey! <span class="glyphicon glyphicon-hand-up"></span></button>
				</a>
			</div>

		<hr>
		</div>
		<!--Footer-->
		<footer class="footer">
			<div class="container">
				<!-- Link to JSON Friends List -->
				<a href="/api/friends" class="footerLinks">API Friends List</a>
				|
				<!-- Link to GitHub -->
				<a href="https://github.com/NJedic/Friend_Finder" class="footerLinks">Git Hub Repo</a>
			</div>
		</footer>
	</div>

	<!--  MODAL -->
  <div id="resultsModal" class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h2 class="modal-title"><strong> <center> Your New Best Friend: </center> </strong></h2>
        </div>
        <div class="modal-body">
            <center>
                <h2 id="matchName">Fill the form to find out !! </h2> </center>
            <center> <img id="matchImg" src="" width="650px" alt=""> </center>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" id="close" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>



<script type="text/javascript">

// On the Submit button click...
$("#submit").on("click", function(event){
	
	// Prevents Page Reset
	event.preventDefault();

	// Capturing User Input Data and Storing it in a variable
	var newFriend = {
		name: $("#name").val().trim(),
		photo: $("#photo").val().trim(),
		scores: [
			$("#q1").val(),
			$("#q2").val(),
			$("#q3").val(),
			$("#q4").val(),
			$("#q5").val(),
			$("#q6").val(),
			$("#q7").val(),
			$("#q8").val(),
			$("#q9").val(),
			$("#q10").val(),
		]
	};

	console.log(newFriend);
	console.log(newFriend.scores)

//validate if all questions were answered
  for (i = 0; i < newFriend.scores.length; i++) {
    if (newFriend.scores[i] === "s") {
        isValid = "false";
    } else isValid = "true";
  }

 //validate whether the user completed the form
  if (newFriend.name === "" || newFriend.photo === "" || isValid === "false") {
      alert("Please fill out the form completely before submiting!");
  } else {
      postRequest();
  }

  // Function to handle the posting of a new friend!
  function postRequest(){
  	// Post to url /api/friends
		$.post("/api/friends", newFriend, function(data){
			
			if (data || data === 0) {
        alert("Please wait while we calculate your new Best Friend!");
        console.log(data);
    	} 
    	else {
        alert("Oh No! Something went wrong! Better try again!");
    	}
    	// Resetting Input fields to empty
    	$("#name").val("");
    	$("#photo").val("");

    	// Calling the findAFriend function and passing the data result from this function through it
    	findAFriend(data);
		})
	}
});

function findAFriend(match){
  // Set a variable to represent the location of the root page.
  var currentURL = window.location.origin;
  // AJAX call
  $.ajax({
    url: currentURL + "/api/friends",
    method: "GET"
	}).done(function(friendsData) {
    console.log("------------------------------------");
    console.log("URL: " + currentURL + "/api/friends");
    console.log("------------------------------------");
    console.log(friendsData[match]);
    console.log("------------------------------------");
    // the best match is the existing friend with the match index
    var bestMatch = friendsData[match];

    // Setting attributes for our Modal
    $("#matchName").html(bestMatch.name);
    $("#matchImg").attr("src", bestMatch.photo);
    // Calling the modal
    $("#resultsModal").modal("show");
      });
};





</script>
</body>
</html>